# Mimic-Red

![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)
![Python](https://img.shields.io/badge/python-3.10+-green.svg)
![DrissionPage](https://img.shields.io/badge/DrissionPage-4.1.0+-orange.svg)
![Code Quality](https://img.shields.io/badge/code%20quality-optimized-brightgreen)

---

## 📖 项目简介

**Mimic-Red** 是一款针对小红书网页版的高性能、低风险数据采集工具。

**Mimic-Red** 采用 **CDP (Chrome DevTools Protocol)** 接管真实浏览器，通过 **DOM 交互** 和 **SSR (Server-Side Rendering) 数据提取** 技术，实现对小红书数据的无感采集。

### 核心特性

*   🕷️ **拟态采集 (Mimicry)**: 接管真实 Chrome 浏览器，复用真实指纹、Cookies 和 LocalStorage，极难被反爬系统检测。
*   👻 **幽灵模式 (Ghost Mode)**: 采用新标签页模式打开详情页，采集完成后自动关闭，完美模拟用户"后台打开"行为。
*   🛡️ **智能风控**: 内置智能延迟（时段感知）、贝塞尔曲线鼠标轨迹、视频笔记自动过滤，大幅降低封号风险。
*   🧹 **数据清洗**: 自动去除 Emoji、无意义标签，格式化为纯文本。
*   💾 **多格式存储**: 支持 **SQLite、CSV、JSON、Excel** 四种存储格式，满足不同使用场景。


---

## 🛡️ 风控与安全（重要）

### ⚠️ 严正警告

**请勿尝试无限制的大规模爬取！**

小红书的反爬策略非常严格（2026年最新），本项目虽然使用了浏览器接管技术来降低特征，但**高频的访问行为**本身就是最大的特征。

### 推荐配置（基于2026年实测数据）

| 使用场景 | 每日上限 | 持续时间 | 风险等级 | 备注 |
|---------|---------|---------|---------|------|
| **新账号/测试期** | 50-100条/天 | 30-60分钟 | 🟢 低 | 建立信任基线 |
| **稳定运行期** | 100-150条/天 | 1-1.5小时 | 🟡 中 | **推荐配置** |
| **数据紧急需求** | 200-300条/天 | 2-2.5小时 | 🟠 高 | 需IP轮换+监控 |

**安全建议**：
*   **间隔设置**: 默认的随机延迟（10-20秒）是经过测试的安全范围，**不要刻意缩短**。
*   **时段建议**: 避开晚高峰（19:00-23:00）和午休时段（12:00-14:00），系统风控更严格。
*   **长期使用**: 建议每周至少休息1-2天，模拟真实用户行为。

### 为什么不能无限爬取？

1.  **账号安全**: 过于频繁的请求会导致账号被暂时风控（无法查看详情、搜索无结果），严重时可能封号。
2.  **IP 限制**: 同一 IP 短时间内请求过多会触发验证码或直接 403。数据中心IP（云服务器）会被立即标记。
3.  **法律风险**: 根据《中国刑法第285条》，爬取超过**100万条记录**可能构成刑事案件（3-7年有期徒刑）。
4.  **可持续性**: 细水长流。本项目旨在辅助个人研究和小规模数据收集，而非商业级的大规模采集。

### 已知检测机制（2026年）

*   **设备指纹**: IMEI、CPU频率、屏幕分辨率、已安装APP列表
*   **网络指纹**: TLS握手特征、HTTP/2请求头顺序、IP信誉评分
*   **行为分析**: 鼠标轨迹完美度、滚动速度均匀性、点击时序（<100ms触发警报）
*   **请求签名**: X-S、X-T、X-B3-Traceid等多层加密验证

**本项目优势**: 使用CDP接管真实浏览器，继承浏览器原生指纹，自动通过签名验证。但IP轮换仍需用户自行配置。

---

## 🛠️ 技术架构

| 模块 | 技术栈 | 说明 |
| :--- | :--- | :--- |
| **浏览器控制** | `DrissionPage` | 基于 CDP 协议，比 Selenium/Playwright 更快、更隐蔽 |
| **数据提取** | `SSR + DOM` | 优先提取 `__INITIAL_STATE__` JSON 数据，DOM 作为兜底 |
| **反爬对抗** | `Mimicry` | 真实浏览器接管 + 拟人化操作 + 随机延迟 |
| **数据存储** | `多格式` | 支持 SQLite/CSV/JSON/Excel 四种格式 |
| **文本处理** | `Regex` | 清洗 Emoji 和特殊字符，优化数据质量 |

---

## 🚀 快速开始

### 1. 环境准备

确保已安装 Python 3.10+ 和 Google Chrome 浏览器。

```bash
# 克隆项目
git clone https://github.com/your-repo/Mimic-Red.git
cd Mimic-Red

# 安装依赖（推荐使用锁定版本）
pip install -r requirements-lock.txt

# 或使用最小版本约束（开发环境）
pip install -r requirements.txt
```

### 2. 启动 Chrome（调试模式）

你需要启动一个开启远程调试端口（9222）的 Chrome 浏览器，并手动登录小红书。

**Mac/Linux:**
```bash
chmod +x start_chrome.sh
./start_chrome.sh
```

**Windows:**
双击运行 `start_chrome.bat` 脚本即可。脚本会自动查找 Chrome 安装路径并开启调试端口。

> **⚠️ 重要**：启动后会自动打开小红书网站，请扫码登录。登录成功后，**不要关闭浏览器窗口**。

### 3. 运行爬虫

```bash
# 最简单用法（默认SQLite存储，爬取20条）
python mimic_red_engine.py -k "澳洲留学"

# 推荐配置（每日限额100条，安全稳定）
python mimic_red_engine.py -k "澳洲留学" -l 20 -d 100 -s sqlite

# 多关键词批量采集
python mimic_red_engine.py \
  -k "悉尼大学" "墨尔本大学" "UNSW" \
  -l 30 -d 150 -s csv --min-likes 50

# 高质量内容精选
python mimic_red_engine.py \
  -k "澳洲移民政策" \
  -l 50 --min-likes 500 -s excel
```

> 📖 **详细使用说明**：请查看 [使用说明.md](./使用说明.md) 了解更多参数和高级配置。

### 常用参数

| 参数 | 简写 | 说明 | 示例 |
|------|------|------|------|
| `--keywords` | `-k` | 关键词列表 | `-k "悉尼大学" "墨尔本"` |
| `--limit` | `-l` | 每个关键词数量 | `-l 50` |
| `--daily-limit` | `-d` | 每日总上限 | `-d 100` |
| `--storage` | `-s` | 存储格式 | `-s csv` |
| `--min-likes` | | 最少点赞数 | `--min-likes 100` |

完整参数列表和使用示例见 [使用说明.md](./使用说明.md)。

---

## ⚠️ 免责声明与法律合规

### 免责声明

1.  本项目仅供 **学习和研究** 使用，请勿用于商业用途。
2.  请遵守 [小红书用户协议](https://www.xiaohongshu.com/protocal/user) 和 [Robots协议](https://www.xiaohongshu.com/robots.txt)。
3.  使用者应对使用本项目产生的一切后果负责，作者不承担任何法律责任。
4.  如需大规模采集数据，请联系小红书官方获取商业授权 API。

### 法律合规（2026年中国法规）

*   ❌ **小红书无官方API**，爬虫行为违反用户服务条款
*   ⚠️ **刑法第285条**: 非法获取计算机信息系统数据罪
*   🔴 **刑事立案红线**: 累计爬取超过 **100万条记录** 可能面临刑事追诉
*   💰 **处罚**: 罚款 + 3-7年有期徒刑（商业用途量刑更重）

**合规建议**:
*   仅用于个人学习/学术研究
*   控制总量 < 10万条
*   不得用于商业盈利、数据转售
*   不得爬取用户隐私数据（联系方式、位置等）

---

## 🤝 贡献与支持

### 升级到最新版本

```bash
# 更新代码
git pull origin main

# 安装最新依赖（推荐锁定版本）
pip install -r requirements-lock.txt
```

### 问题反馈

如遇到问题，请：

1. 查看 [使用说明.md](./使用说明.md) 中的常见问题排查
2. 搜索 [Issues](https://github.com/your-repo/issues) 中是否有类似问题
3. 提交新 Issue 时，请附上：
   - 错误日志（完整的终端输出）
   - 使用的命令
   - Python版本（`python --version`）
   - 操作系统版本

### Star History

如果这个项目对你有帮助，请给个 ⭐️ Star！

---

## 📄 许可证

本项目采用 [MIT License](LICENSE)。


